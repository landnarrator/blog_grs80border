<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GRS80 지역좌표 경계선 표시</title>
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    crossorigin=""
  />
  <style>
    html, body { height: 100%; margin: 0; }
    #map { height: 100%; width: 100%; }

    .zone-label span {
      background: white;
      padding: 0.3em 0.5em;
      border-radius: 4px;
      font-size: clamp(10px, 3vw, 14px);
      color: black;
      display: inline-block;
      white-space: nowrap;
    }

    .origin-label {
      color: red;
      font-weight: bold;
      font-size: clamp(9px, 2.5vw, 13px);
      text-align: left;
      text-shadow: 1px 1px 2px white;
      white-space: nowrap;
    }

    .leaflet-control.custom {
      background: white;
      padding: clamp(4px, 1.5vw, 8px) clamp(6px, 2vw, 10px);
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      font-size: clamp(10px, 3vw, 13px);
      max-width: 90vw;
      overflow-wrap: break-word;
    }

    .leaflet-control-layers {
      max-height: 50vh;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
  <script>
    const map = L.map('map', { zoomControl: true, minZoom: 5, maxZoom: 18 });

    const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    map.fitBounds([[33.0, 124.0], [39.6, 132.0]]);

    function meridianPolyline(lon, latMin = 32.0, latMax = 40.5, step = 0.05) {
      const latlngs = [];
      for (let lat = latMin; lat <= latMax; lat += step) latlngs.push([lat, lon]);
      return L.polyline(latlngs, { color: 'red', weight: 2.5, dashArray: '6,6' });
    }

    const boundaries = L.layerGroup([meridianPolyline(126), meridianPolyline(128), meridianPolyline(130)]).addTo(map);

    function zoneLabel(text, lat, lon) {
      return L.marker([lat, lon], {
        icon: L.divIcon({ className: "zone-label", html: `<span>${text}</span>`, iconSize: null }),
        interactive: false
      });
    }

    const labels = L.layerGroup([
      zoneLabel('서부 (124°E–126°E)', 39.3, 124.3),
      zoneLabel('중부 (126°E–128°E)', 39.3, 126.3),
      zoneLabel('동부 (128°E–130°E)', 39.3, 128.3),
      zoneLabel('동해 (130°E–132°E)', 39.3, 130.3)
    ]).addTo(map);

    function originLabel(text, lat, lon) {
      return L.marker([lat, lon], { icon: L.divIcon({ className: 'origin-label', html: text, iconAnchor: [0,0] }), interactive: false });
    }

    const origins = L.layerGroup([
      L.circleMarker([38.0, 125.0], { radius:5, color:'red', fillColor:'red', fillOpacity:1.0 }),
      originLabel('서부 원점 (38N, 125E)', 38.0, 125.0),
      L.circleMarker([38.0, 127.0], { radius:5, color:'red', fillColor:'red', fillOpacity:1.0 }),
      originLabel('중부 원점 (38N, 127E)', 38.0, 127.0),
      L.circleMarker([38.0, 129.0], { radius:5, color:'red', fillColor:'red', fillOpacity:1.0 }),
      originLabel('동부 원점 (38N, 129E)', 38.0, 129.0),
      L.circleMarker([38.0, 131.0], { radius:5, color:'red', fillColor:'red', fillOpacity:1.0 }),
      originLabel('동해 원점 (38N, 131E)', 38.0, 131.0)
    ]).addTo(map);

    const overlayMaps = {
      '경계선 (126E·128E·130E)': boundaries,
      '영역 라벨': labels,
      '원점': origins
    };

    const baseMaps = { 'OpenStreetMap': osm };

    // 레이어 컨트롤: 기본 접힘 상태(collapsed: true)
    L.control.layers(baseMaps, overlayMaps, { collapsed: true }).addTo(map);

    const info = L.control({ position: 'topleft' });
    info.onAdd = function() {
      const div = L.DomUtil.create('div', 'leaflet-control custom');
      div.innerHTML = `
        <b>GRS80 지역좌표 경계선</b><br/>
        세로 빨간 점선은 좌표계 경계(경도)입니다.<br/>
        • 서부–중부: 126°E<br/>
        • 중부–동부: 128°E<br/>
        • 동부–동해: 130°E<br/>
        <span style="color:red">붉은 ● = 원점 좌표</span>
      `;
      return div;
    };
    info.addTo(map);

    window.addEventListener('resize', () => map.invalidateSize());
  </script>
</body>
</html>
